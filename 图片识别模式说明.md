# 图片识别模式说明

## 🎉 重大改进！

自动答题系统现在使用**图片识别模式**，直接发送截图给豆包AI识别，无需安装OCR软件！

## 工作原理

### 旧方案（OCR模式）
```
截图 → Tesseract-OCR识别文字 → 发送文字给AI → 获取答案
```
**缺点：**
- ❌ 需要安装Tesseract-OCR
- ❌ 需要配置环境变量
- ❌ OCR识别可能不准确
- ❌ 配置复杂

### 新方案（图片模式）✨
```
截图 → 直接发送图片给豆包AI → AI识别并回答 → 获取答案
```
**优点：**
- ✅ 无需安装OCR软件
- ✅ 无需配置环境变量
- ✅ 识别更准确（豆包多模态能力）
- ✅ 配置超简单
- ✅ 支持复杂题目（图表、公式等）

## 技术实现

系统利用豆包API的图片上传和多模态识别能力：

1. **截取题目区域** - 使用PIL截图
2. **上传图片** - 调用 `/api/file/upload` 上传截图
3. **AI识别** - 调用 `/api/chat/completions` 发送图片附件
4. **获取答案** - 豆包直接识别图片并返回答案

## 代码对比

### 旧代码（OCR模式）
```python
# 截图
image = screen_capture.capture_region(x, y, w, h)

# OCR识别
text = ocr_service.extract_text(image)  # 需要Tesseract

# 发送文字给AI
answer = await ai_service.get_answer(question=text)
```

### 新代码（图片模式）
```python
# 截图
image = screen_capture.capture_region(x, y, w, h)

# 直接发送图片给AI
answer = await ai_service.get_answer(image=image)  # 无需OCR！
```

## 使用方法

完全透明！用户无需做任何改变：

1. 安装依赖：`pip install -r requirements.txt`
2. 启动豆包API：`python app.py`
3. 启动自动答题：`python auto_answer_main.py`
4. 配置并开始答题

就这么简单！

## 兼容性

如果你想切换回OCR模式（比如豆包API不支持图片），可以修改 `auto_answer_main.py`：

```python
self.controller = AnswerController(
    self.config_manager, 
    gui_callbacks,
    use_image_mode=False  # 改为False使用OCR模式
)
```

然后需要安装Tesseract-OCR。

## 性能对比

| 特性 | OCR模式 | 图片模式 |
|------|---------|----------|
| 安装难度 | 复杂 | 简单 |
| 识别准确率 | 中等 | 高 |
| 支持题型 | 纯文字 | 文字+图表+公式 |
| 响应速度 | 快 | 稍慢（上传图片） |
| 依赖软件 | Tesseract-OCR | 无 |

## 常见问题

### Q: 图片模式会更慢吗？
A: 会稍慢一点（需要上传图片），但识别更准确，总体效率更高。

### Q: 豆包API支持图片吗？
A: 是的！豆包支持多模态，可以识别图片中的文字、图表、公式等。

### Q: 可以同时使用两种模式吗？
A: 可以！在代码中切换 `use_image_mode` 参数即可。

### Q: 图片模式有大小限制吗？
A: 建议截图不要太大，一般题目区域足够了。

## 总结

图片识别模式是更优雅的解决方案：
- 🚀 更简单 - 无需安装OCR
- 🎯 更准确 - 利用豆包多模态能力
- 💪 更强大 - 支持复杂题目

这就是为什么我们默认使用图片模式！🎉
