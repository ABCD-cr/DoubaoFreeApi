# 问题修复说明

## 问题描述

在之前的版本中，系统运行时出现错误：
```
会话配置不存在,请检查 session.config 文件
```

## 问题原因

AI服务使用了 `guest=True`（游客模式），但是：
1. `session.json` 中配置的是登录账号信息
2. Session池将所有session加载为登录账号（`guest=False`）
3. 当请求游客session时，池中没有游客session，返回 `None`
4. 导致API调用失败

## 解决方案

修改 `src/auto_answer/services/ai_service.py`：
- 将 `guest=True` 改为 `guest=False`
- 将 `conversation_id="0"` 改为 `conversation_id=None`

这样系统会使用 `session.json` 中配置的登录账号信息。

## 修改内容

### 修改前
```python
payload = {
    "prompt": "...",
    "guest": True,  # 使用游客模式
    "conversation_id": "0",
    ...
}
```

### 修改后
```python
payload = {
    "prompt": "...",
    "guest": False,  # 使用登录模式
    "conversation_id": None,  # 每次新对话
    ...
}
```

## 优势

使用登录模式的优势：
1. ✅ **更稳定**：不受游客5次限制
2. ✅ **更可靠**：使用真实账号，不会被限制
3. ✅ **支持上下文**：如果需要可以保持对话上下文
4. ✅ **功能完整**：可以使用所有豆包功能

## 使用说明

### 前提条件
**必须先配置 `session.json` 文件！**

参考 `如何配置Session.md` 获取并配置你的豆包账号信息。

### 启动系统
```bash
python auto_answer_main.py
```

### 操作流程
1. 点击"启动API服务"
2. 等待显示"API: 运行中 ✓"
3. 配置题目区域和答案选项
4. 点击"开始答题"

## 测试验证

修复后，系统应该能够：
- ✅ 成功启动API服务
- ✅ 成功上传图片
- ✅ 成功获取AI回答
- ✅ 自动点击答案并进入下一题

## 注意事项

1. **必须配置session.json**：这是使用系统的前提
2. **每次新对话**：`conversation_id=None` 确保每题独立，避免上下文干扰
3. **保持登录**：确保session.json中的cookie有效

## 相关文件

- `src/auto_answer/services/ai_service.py` - AI服务（已修复）
- `session.json` - 账号配置（需要用户配置）
- `如何配置Session.md` - 配置指南

## 修复日期

2026-01-30

---

现在系统应该可以正常工作了！🎉
